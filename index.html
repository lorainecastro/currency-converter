<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Currency Converter</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
</head>
<body>
    <div class="bg-circle bg-circle-1"></div>
    <div class="bg-circle bg-circle-2"></div>
    <div class="bg-circle bg-circle-3"></div>
    <div class="bg-circle bg-circle-4"></div>

    <div class="container">
        <div class="header">
            <div class="brand-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor">
                    <path d="M440 96c0-35.3-57.3-64-128-64S184 60.7 184 96s57.3 64 128 64 128-28.7 128-64zm0 80c0 35.3-57.3 64-128 64s-128-28.7-128-64v48c0 35.3 57.3 64 128 64s128-28.7 128-64v-48zm0 112c0 35.3-57.3 64-128 64s-128-28.7-128-64v48c0 35.3 57.3 64 128 64s128-28.7 128-64v-48zM80 160c-44.2 0-80 21.5-80 48s35.8 48 80 48 80-21.5 80-48-35.8-48-80-48zm80 80c0 26.5-35.8 48-80 48S0 266.5 0 240v48c0 26.5 35.8 48 80 48s80-21.5 80-48v-48zm0 80c0 26.5-35.8 48-80 48S0 346.5 0 320v48c0 26.5 35.8 48 80 48s80-21.5 80-48v-48z"/>
                </svg>
            </div>
            <h1>Currency Converter</h1>
            <p>Convert currencies in real-time</p>
        </div>

        <label for="amount">Amount</label>
        <input type="number" id="amount" value="1" placeholder="Enter amount" min="0" step="0.01">

        <div class="currency-group">
            <div>
                <label for="from-select">From</label>
                <select id="from-select"></select>
            </div>
            <i class="fas fa-exchange-alt swap-icon"></i>
            <div>
                <label for="to-select">To</label>
                <select id="to-select"></select>
            </div>
        </div>

        <div id="result"></div>
        <div id="error"></div>

        <div class="notification" id="notification"></div>
    </div>

    <script>
        const API_HOST = 'https://api.frankfurter.dev/v1';

        async function fetchCurrencies() {
            try {
                const response = await fetch(`${API_HOST}/currencies`);
                if (!response.ok) throw new Error('Failed to fetch currencies');
                const data = await response.json();
                return Object.keys(data).sort();
            } catch (error) {
                console.error(error);
                showNotification('Failed to fetch currencies', 'error');
                return [];
            }
        }

        async function populateSelects() {
            const currencies = await fetchCurrencies();
            if (currencies.length === 0) {
                document.getElementById('error').textContent = 'Failed to load currencies.';
                return;
            }

            const fromSelect = document.getElementById('from-select');
            const toSelect = document.getElementById('to-select');

            currencies.forEach(currency => {
                const option1 = document.createElement('option');
                option1.value = currency;
                option1.textContent = currency;
                fromSelect.appendChild(option1);

                const option2 = document.createElement('option');
                option2.value = currency;
                option2.textContent = currency;
                toSelect.appendChild(option2);
            });

            fromSelect.value = 'USD';
            toSelect.value = 'PHP';

            fromSelect.addEventListener('change', convertCurrency);
            toSelect.addEventListener('change', convertCurrency);

            convertCurrency();
        }

        async function convertCurrency() {
            const amount = parseFloat(document.getElementById('amount').value);
            const from = document.getElementById('from-select').value;
            const to = document.getElementById('to-select').value;
            const resultDiv = document.getElementById('result');
            const errorDiv = document.getElementById('error');

            resultDiv.textContent = '';
            errorDiv.textContent = '';

            if (isNaN(amount) || amount <= 0) {
                showNotification('Please enter a valid positive amount', 'error');
                return;
            }

            if (from === to) {
                resultDiv.textContent = `${amount.toFixed(2)} ${from} = ${amount.toFixed(2)} ${to}`;
                showNotification('Currencies are the same', 'success');
                return;
            }

            try {
                const response = await fetch(`${API_HOST}/latest?base=${from}&symbols=${to}`);
                if (!response.ok) throw new Error('Failed to fetch exchange rate');
                const data = await response.json();
                const rate = data.rates[to];
                const converted = (amount * rate).toFixed(2);
                resultDiv.textContent = `${amount.toFixed(2)} ${from} = ${converted} ${to}`;
                showNotification('Conversion successful', 'success');
            } catch (error) {
                console.error(error);
                showNotification('Failed to convert. Please try again.', 'error');
            }
        }

        function swapCurrencies() {
            const fromSelect = document.getElementById('from-select');
            const toSelect = document.getElementById('to-select');

            const tempValue = fromSelect.value;
            fromSelect.value = toSelect.value;
            toSelect.value = tempValue;

            convertCurrency();
        }

        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;

            if ('vibrate' in navigator && type === 'error') {
                navigator.vibrate([100, 50, 100]);
            }

            setTimeout(() => {
                notification.className = 'notification';
            }, 3000);
        }

        document.addEventListener('mousemove', function(e) {
            const x = e.clientX / window.innerWidth;
            const y = e.clientY / window.innerHeight;

            const circles = document.querySelectorAll('.bg-circle');
            circles.forEach((circle, index) => {
                const speed = (index + 1) * 0.05;
                const translateX = (x * 20 * speed) - (10 * speed);
                const translateY = (y * 20 * speed) - (10 * speed);
                circle.style.transform = `translate(${translateX}px, ${translateY}px)`;
            });
        });

        populateSelects();

        document.getElementById('amount').addEventListener('input', convertCurrency);
        document.querySelector('.swap-icon').addEventListener('click', swapCurrencies);
    </script>
</body>
</html>